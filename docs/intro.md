---
title: Nimble
slug: /
---

## Nimble Exporter

Это HTTP-сервер на базе Go, предназначенный для сбора и представления метрик с сервера Nimble Stream в целях мониторинга. Он собирает информацию о SRT-отправителях, SRT-получателях и общем состоянии сервера, представляя ее в формате, совместимом с системами мониторинга, такими как Prometheus.

## Прометей (Prometheus)

Это система мониторинга и сбора метрик с открытым исходным кодом, которая используется для наблюдения за состоянием и производительностью инфраструктуры и приложений. Она была разработана компанией **SoundCloud** и является частью фонда **Cloud Native Computing Foundation** (CNCF), как и Kubernetes.

## Основные области применения:

* Мониторинг серверов и инфраструктуры.
* Наблюдение за микросервисами и контейнерными системами (включая Kubernetes).
* Отслеживание производительности веб-приложений.
* Настройка оповещений на основе метрик.

## Как использовать

```bash
- name: srt-exporter
    image: {{ $.Values.werf.image.exporter }}
    command:
    - /nimble_exporter
    - -auth_salt=590
    - -auth_hash=xxxx
    ports:
    - containerPort: 9017
        name: exporter
        protocol: TCP
    resources:
        {{ toYaml $.Values.resources.exporter | nindent 10 }}
```

## Особенности

* Сбор метрик: Экспортер собирает различные метрики, связанные с отправителями и получателями SRT (Secure Reliable Transport), такие как потеря пакетов, RTT (Round Trip Time), пропускная способность и другая сетевая статистика.
* Мониторинг состояния сервера: Он также собирает общую статистику сервера, включая количество соединений, скорость передачи данных, размер оперативной памяти и файлового кэша, а также показатели системной информации.
* Настраивается с помощью флагов: Экспортер можно настроить с помощью флагов командной строки для адреса прослушивания, адреса сервера Nimble, деталей аутентификации, уровня протоколирования и формата вывода.
* Совместимый с Prometheus вывод: Собранные метрики оформляются в формате, совместимом с Prometheus, что позволяет легко интегрировать их в существующие системы мониторинга.

## Настройка Prometheus Exporter для сбора метрик с CRM

### Загрузка и размещение Prometheus Exporter

* Скачайте Prometheus Exporter (экспортер метрик) на сервер, где размещена CRM.
* Экспортер будет использоваться для сбора метрик с CRM и передачи этих данных в Prometheus.

### Настройка конфигурации

* Внесите изменения в конфигурационный файл экспортера, чтобы он корректно собирал метрики с CRM. Это может быть информация об API, базе данных или других системных метриках.
* Убедитесь, что экспортер правильно настроен для доступа ко всем необходимым компонентам CRM.

### Запуск и проверка

* Запустите экспортер на сервере. Он начнет собирать метрики с CRM и предоставлять их в формате, совместимом с Prometheus.
* Проверьте доступность метрик через URL-адрес, предоставляемый экспортером (например, `http://localhost:9100/metrics`).

### Интеграция с Prometheus:

* В конфигурации Prometheus (файл `prometheus.yml`) добавьте новую секцию для вашего экспортера. Укажите его адрес и порт, на котором он работает, чтобы Prometheus мог запрашивать метрики:
    ```bash
    scrape_configs:
    - job_name: 'crm-exporter'
        static_configs:
        - targets: ['localhost:9100']
    ```      
* Prometheus самостоятельно запрашивает метрики у указанного экспортера с заданной периодичностью.

### Мониторинг и визуализация

* Убедитесь, что метрики успешно появляются в интерфейсе Prometheus или в инструментах визуализации, таких как Grafana.
* Настройте оповещения на основе критических метрик для обеспечения стабильной работы CRM.

### Конечные точки

* Конечная точка базовой проверки работоспособности, отвечающая на /metricsatus 200.
* **metrics**: Основная конечная точка, которая возвращает собранные метрики в формате, совместимом с Prometheus.
